# 环境

安装dosbox

示例代码

```asm
assume cs:codesg
codesg segment
	mov ax,0123h
	mov bx,0456h
	add ax,bx
	add ax,ax
	
	mov ax,4c00h
	int 21h   
codesg ends
end
	
	
```



1. ### 源程序

   - 伪指令

     伪指令不被编译，不会被编译成机器指令，编译器需要根据伪指令来编译源程序

     代码示例中，前两行和最后两行都是伪指令，中间部分为汇编指令

     - codesg segment .....  codesg ends 

       中间的部分被称为一个程序段，用来存放汇编指令

       每个程序至少需要一个程序段才有意义

     - end

       表示程序的结束

     - assume

       将代码段与段寄存器cs连接起来

   - 汇编指令

     会被编译器编译为机器码，程序

   - 标号

   - 程序返回

     程序执行时是由一个程序加载，然后将cpu控制权交出，当该程序返回后，控制权重新回来的过程

     返回指令：mov ax,4c00h

     ​			int 21h

   - 

2. ### 编译执行过程

   - 编译

     用masm.exe编译.asm后缀的源文件，生成一个.obj结尾的文件

   - 连接

     通过link.exe将obj文件转化成可执行文件

     **连接的作用**：

     - 当源程序很大，会拆分成多个文件进行编译生成多个目标文件，连接程序将目标文件连接在一起生成可执行文件
     - 引用一些第三方库时，需要将程序的目标文件和第三方库的目标文件连接起来
     - 源程序编译后生成目标文件，但目标文件中有些内容还不能直接生成可执行文件，需要通过连接处理生成可执行文件

   - 使用debug跟踪程序

     R：查看各寄存器的信息

     U：查看程序其他代码

     T：单步执行

     P：直接跳转到int 21h

     Q：退出debug

     G：跳过循环

3. ### exe程序加载过程

   运行debug

   ![1572098867154](pic\1572098867154.png)

   cx为exe的长度，cx=35表示该程序有53个字节

   程序加载过程

   ![1572099403263](pic\1572099403263.png)

   ds表示程序加载开始的位置，ds=075a，由于存在psp区占用256字节，用来与程序通信，所以程序的入口在ds+10h:0处开始

   即是076a:0处开始

   

4. 